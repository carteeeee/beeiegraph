<!doctype html>
<html>
    <head>
        <title>beeie node graph | versions</title>
        <meta name="charset" content="UTF-8">
        <script src="/js/nodegraph.js"></script>
        <link rel="stylesheet" href="/css/graphs.css">
    </head>
    <body>
        <canvas id="canvas" width="1000" height="500"></canvas>
        <script>
            fetch("/assets/versions.json")
                .then(res => {
                    if (!res.ok) throw new Error(`the bee is not okay: ${res.status}`);
                    return res.json();
                })
                .then(data => {
                    startGraph(data);
                })
                .catch(error => {
                    alert("there was an error, please check the console!");
                    console.error(error);
                });

            const startGraph = data => {
                let canvas = document.getElementById("canvas");
                let graph = new NodeGraph(canvas, "white", data);
                let last = null;

                const update = timestamp => {
                    if (!last) last = timestamp;
                    let delta = timestamp - last;
                    last = timestamp;
                    graph.draw(delta);
                    requestAnimationFrame(update);
                }
                
                requestAnimationFrame(update);
            }
        </script>
    </body>
</html>
